# ldd

ldd（list dynamic dependencies）は、[[ELF]]形式の実行可能ファイルや[[共有ライブラリ]]が依存する[[動的ライブラリ]]の一覧とその場所を表示するLinuxコマンドである。ライブラリの依存関係を調査する際や、アプリケーションが正常に動作するために必要なライブラリが揃っているかを確認する際に使用される。

## 基本的な使用方法

```bash
ldd [オプション] ファイル名
```

### 例

```bash
# 実行可能ファイルの依存ライブラリを表示
ldd /bin/ls

# 共有ライブラリの依存関係を表示
ldd /lib/x86_64-linux-gnu/libc.so.6
```

## 主なオプション

- `-d, --data-relocs`: データの[[再配置]]を実行し、不足している関数や変数を報告
- `-r, --function-relocs`: データと関数の再配置を実行し、不足しているオブジェクトを報告
- `-v, --verbose`: 詳細情報を表示（バージョン情報を含む）
- `-u, --unused`: 使用されていない直接の依存関係を表示

## 出力形式

lddの出力は通常、以下の形式で表示される：

```
ライブラリ名 => ライブラリのパス (ベースアドレス)
```

例：
```
linux-vdso.so.1 (0x00007fff123ab000)
libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007f1234567000)
/lib64/ld-linux-x86-64.so.2 (0x00007f1234789000)
```

## 動作原理

lddは実際には[[動的リンカ]]（ld.so）のラッパーであり、`LD_TRACE_LOADED_OBJECTS`環境変数を設定してプログラムを実行することで依存関係を表示する。

## 使用例と応用

### アプリケーションの動作確認

```bash
# アプリケーションが必要とするライブラリがすべて存在するか確認
ldd /usr/bin/firefox
```

### ライブラリの場所特定

特定のライブラリがどこから読み込まれているかを確認する際に有用である。これは、複数のバージョンのライブラリがシステムに存在する場合の[[ライブラリパス]]の解決順序を理解するのに役立つ。

### 静的リンクされたバイナリの識別

静的リンクされたバイナリに対してlddを実行すると、「not a dynamic executable」というメッセージが表示される。

## 注意事項

- lddは対象プログラムを部分的に実行する可能性があるため、信頼できないバイナリに対して使用する際は注意が必要
- [[setuid]]プログラムに対しては、セキュリティ上の理由から動作しない
- 32ビットと64ビットのバイナリでは依存するライブラリが異なる場合がある

## 関連コマンド

- `objdump -p`: より詳細なバイナリ情報を表示
- `readelf -d`: ELFファイルの動的セクション情報を表示
- `nm`: シンボルテーブルを表示
- `file`: ファイルタイプを確認