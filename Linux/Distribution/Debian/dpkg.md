# dpkg

dpkg（Debian Package）はDebian系ディストリビューションで使用される低レベルパッケージ管理ツールです。パッケージのインストール、削除、情報取得などを行います。

## 主なコマンド

- `dpkg -i <package.deb>`: パッケージのインストール
- `dpkg -r <package>`: パッケージの削除（設定ファイルは残す）
- `dpkg -P <package>`: パッケージの完全削除（設定ファイルも削除）
- `dpkg -l [pattern]`: インストール済みパッケージの一覧表示
- `dpkg -L <package>`: パッケージがインストールしたファイル一覧
- `dpkg -S <file>`: ファイルが属するパッケージを検索
- `dpkg --configure -a`: 未設定のパッケージを設定
- `dpkg -E`, `dpkg --skip-same-version`: 同じバージョンがすでにインストールされている場合、インストールや削除をスキップ
- `dpkg -G`, `dpkg --refuse-downgrade`: インストールするパッケージのバージョンが現在のものより古い場合、ダウングレードを拒否
- `dpkg --help`: ヘルプの表示

## 状態ファイル

dpkgは`/var/lib/dpkg/`ディレクトリにパッケージ状態情報を保存します。主なファイル:

- `status`: インストール済みパッケージの状態情報
- `available`: 利用可能なパッケージ情報（aptキャッシュに利用される）
- `diversions`, `info/` などのサブディレクトリ

## 使いどころ

dpkgはaptやapt-getの下層で動作し、依存関係の解決やリポジトリ管理は行いません。ローカルにダウンロードした`.deb`を直接操作したり、トラブルシュート時に状態を確認・修復したりする際に使用します。