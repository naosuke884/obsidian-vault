# APT

[[APT]]（Advanced Package Tool）は、[[Debian]]系Linuxディストリビューションで使用されるパッケージ管理システムです。[[dpkg]]の上位層として動作し、パッケージの依存関係の解決やリポジトリからのダウンロードを自動化します。

## 主要コマンド

### パッケージ情報の取得
- `apt list` - インストール可能なパッケージ一覧を表示
- `apt list --installed` - インストール済みパッケージ一覧を表示
- `apt list --upgradable` - アップグレード可能なパッケージ一覧を表示
- `apt search <パッケージ名>` - パッケージを検索
- `apt show <パッケージ名>` - パッケージの詳細情報を表示

### パッケージの操作
- `apt update` - パッケージリストを更新
- `apt upgrade` - インストール済みパッケージをアップグレード
- `apt full-upgrade` - システム全体をアップグレード（依存関係の変更を含む）
- `apt install <パッケージ名>` - パッケージをインストール
- `apt remove <パッケージ名>` - パッケージを削除（設定ファイルは残存）
- `apt purge <パッケージ名>` - パッケージを完全削除（設定ファイルも削除）
- `apt autoremove` - 不要になった依存パッケージを自動削除

### システム管理
- `apt clean` - ダウンロード済みパッケージファイルを削除
- `apt autoclean` - 古いパッケージファイルのみ削除

### apt-cacheコマンド
- `apt-cache search <キーワード>` - パッケージ名や説明文からパッケージを検索
- `apt-cache show <パッケージ名>` - パッケージの詳細情報を表示
- `apt-cache depends <パッケージ名>` - パッケージの依存関係を表示
- `apt-cache rdepends <パッケージ名>` - パッケージに依存している他のパッケージを表示
- `apt-cache policy <パッケージ名>` - パッケージのバージョン情報とインストール状況を表示
- `apt-cache pkgnames` - 利用可能なすべてのパッケージ名を表示
- `apt-cache stats` - パッケージキャッシュの統計情報を表示
- `apt-cache showpkg <パッケージ名>` - パッケージの詳細な依存関係情報を表示

## 設定ファイル

### /etc/apt/sources.list
パッケージリポジトリの設定ファイルです。リポジトリのURL、ディストリビューション、コンポーネントを定義します。

```
deb http://deb.debian.org/debian bullseye main
deb-src http://deb.debian.org/debian bullseye main
```

### /etc/apt/sources.list.d/
追加のリポジトリ設定ファイルを格納するディレクトリです。サードパーティのリポジトリ設定は通常ここに配置されます。

### /etc/apt/apt.conf
APTの動作設定を行うファイルです。プロキシ設定やダウンロードの振る舞いなどを制御できます。

## 依存関係の解決

APTは[[dpkg]]とは異なり、パッケージの依存関係を自動的に解決します。インストール時に必要な依存パッケージを自動的にダウンロード・インストールし、削除時には依存関係を考慮して安全に操作を実行します。

## キャッシュ機能

ダウンロードしたパッケージファイルは`/var/cache/apt/archives/`に保存され、再インストール時の高速化を図ります。`apt clean`コマンドでキャッシュを削除できます。

## セキュリティ

APTは[[GPG]]による署名検証機能を持ち、パッケージの改ざんやなりすましを防止します。リポジトリの公開鍵は`/etc/apt/trusted.gpg`や`/etc/apt/trusted.gpg.d/`で管理されます。

## apt vs apt-get

従来の`apt-get`に比べて`apt`コマンドは：
- より直感的なユーザーインターフェース
- プログレスバーの表示
- カラー出力対応
- よく使用される機能の統合

日常的な使用では`apt`コマンドが推奨されますが、スクリプトでの使用には`apt-get`が適しています。