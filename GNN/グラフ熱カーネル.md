---
tags:
  - gnn
  - graph-heat-kernel
  - spectral-graph-theory
---

# グラフ熱カーネル

グラフ上の熱拡散過程をモデル化した[[カーネル関数]]。連続時間での熱方程式の解として定義され、グラフ上の局所的な類似性を測定するために使用される。

## 数学的定義

[[グラフラプラシアン]] $L$ を用いて、グラフ熱カーネルは以下のように定義される：

$$H_t = \exp(-tL)$$

ここで、$t > 0$ は拡散時間パラメータである。

[[固有値分解]] $L = U\Lambda U^T$ を利用すると、以下のように表現できる：

$$H_t = U \exp(-t\Lambda) U^T$$

各要素は次のように計算される：

$$H_t(i,j) = \sum_{k=1}^n u_k(i) u_k(j) e^{-t\lambda_k}$$

ここで、$u_k$ は $k$ 番目の固有ベクトル、$\lambda_k$ は対応する固有値である。

## 物理的解釈

グラフ熱カーネルは、ノード $i$ から始まった熱が時間 $t$ 後にノード $j$ に到達する確率密度を表す。小さい $t$ では局所的な構造を反映し、大きい $t$ では大域的な構造を捉える。

## 性質

1. **対称性**: $H_t(i,j) = H_t(j,i)$
2. **正定値性**: すべての実数値関数に対して正定値
3. **確率的解釈**: 各行の和は1に収束
4. **時間発展**: $\frac{d}{dt}H_t = -LH_t$

## 計算上の考慮

直接的な行列指数の計算は計算コストが高いため、以下の近似手法がよく用いられる：

- **固有値分解による計算**: 小規模グラフに適用
- **[[チェビシェフ多項式]]近似**: 大規模グラフでの効率的計算
- **ランダムウォークによる近似**: モンテカルロ手法

## [[スペクトルグラフ畳み込み]]との関係

グラフ熱カーネルは[[スペクトルグラフ畳み込み]]において、フィルタ関数 $g_\theta(\lambda) = e^{-t\lambda}$ として利用される。これにより、局所的な特徴の平滑化効果を持つ畳み込み演算が実現される。